test_suites:
  - name: "build"
    abort_commit_on_failure: true
    criteria: MERGE
    # prereq_test_suite_name:
    #   - "test"
    # queue_name: ci-queue-productionJenga-AL2023
    queue_name: small
    # script_name: build
    script_path: /root/okta/odyssey/scripts
    sort_order: "4"
    steps:
      - event: SOURCE
        action: setup.sh
        name: Setup Environment
      - event: COMMAND
        action: yarn build
        name: Build Packages
    timeout: "20"

  - name: "lint"
    abort_commit_on_failure: true
    criteria: MERGE
    queue_name: small
    script_name: lint
    script_path: /root/okta/odyssey/scripts
    sort_order: "1"
    steps:
      - event: SOURCE
        action: setup.sh
        name: Setup Environment
      - event: COMMAND
        action: yarn lint
        name: Lint Code
    timeout: "20"

  - name: "test"
    abort_commit_on_failure: true
    criteria: MERGE
    queue_name: small
    script_name: test
    script_path: /root/okta/odyssey/scripts
    sort_order: "3"
    steps:
      - event: SOURCE
        action: setup.sh
        name: Setup Environment
      - event: COMMAND
        action: yarn test
        name: Test Code
    timeout: "20"

  - name: "typecheck"
    abort_commit_on_failure: true
    criteria: MERGE
    queue_name: small
    script_name: typecheck
    script_path: /root/okta/odyssey/scripts
    sort_order: "2"
    steps:
      - event: SOURCE
        action: setup.sh
        name: Setup Environment
      - event: COMMAND
        action: yarn typecheck
        name: Typecheck Code
    timeout: "20"

  - name: semgrep
    criteria: MERGE
    queue_name: small
    script_name: semgrep
    script_path: /root/okta/odyssey/scripts
    sort_order: "5"
    timeout: "10"
